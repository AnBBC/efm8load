NOTE: this is all untested! 
